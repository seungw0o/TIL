# ROUTING

## NEXT?

NextëŠ” `Reactê¸°ë°˜ í”„ë ˆì„ì›Œí¬`ì´ë‹¤.

> í”„ë ˆì„ì›Œí¬ vs ë¼ì´ë¸ŒëŸ¬ë¦¬
> `ë¼ì´ë¸ŒëŸ¬ë¦¬` : ê°œë°œìê°€ ì§ì ‘ ì½”ë“œë¥¼ ì§œëŠ” í˜•íƒœì´ë‹¤.
> `í”„ë ˆì„ì›Œí¬` : ê·œì¹™ë§Œ ë”°ë¥´ë©´ ìë™ìœ¼ë¡œ ì½”ë“œë¥¼ ì§œì¤€ë‹¤.

ìœ„ ì„¤ëª…ì„ ì˜ˆë¡œ ë“¤ìë©´..
Reactì—ì„œ ì²«ë²ˆì§¸ í™”ë©´ì„ ê°œë°œí•˜ê¸° ìœ„í•´ì„œëŠ” ì½”ë“œë¥¼ ì¼ì¼íˆ ì§œê³  ì§ì ‘ ê²½ë¡œë¥¼ ì„¤ì •í•˜ëŠ” ê³¼ì •ì„ ê±°ì³ì•¼ í•˜ì§€ë§Œ
NextëŠ” app/page.tsx ë¼ëŠ” íŒŒì¼ì— í•¨ìˆ˜ë¥¼ exportí•˜ë©´? ì•Œì•„ì„œ ì½”ë“œë¥¼ ì§œì¤€ë‹¤.

```tsx
export default function FirstPage() {
  // app í´ë” ì† page.tsx íŒŒì¼ì˜ ì½”ë“œ
  return <h1>bye Page!</h1>;
}
```

## Nextì˜ ë¼ìš°íŒ… ë°©ì‹

reactì˜ ê²½ìš° ì§ì ‘ urlì„ ì„¤ì •í›„ í˜ì´ì§€ë¥¼ ë¼ìš°íŒ… í•˜ëŠ” ë°©ë²•ìœ¼ë¡œ ë¼ìš°íŒ…ì„ ì§„í–‰ í–ˆë‹¤.
í•˜ì§€ë§Œ nextì˜ ê²½ìš° ì˜ˆë¥¼ ë“¤ì–´ company/salses/page.tsx ëŠ” [localhost:3000/company/sales](http://localhost:3000/company/sales) ë¥¼ ëœ»í•œë‹¤.
ì´ë¥¼ í†µí•´ ì•Œ ìˆ˜ ìˆë“¯ì´ nextëŠ” íŒŒì¼ë§Œ ë§Œë“¤ê³  ì•½ê°„ì˜ ê·œì¹™ë§Œ ë”°ë¥¸ë‹¤ë©´ ë¼ìš°íŒ…ì„ ì‰½ê³  ë¹ ë¥´ê²Œ í•  ìˆ˜ ìˆë‹¤.

```tsx
// ë¼ìš°íŒ… ë°©ë²• Link íƒœê·¸ ì´ìš©
<Link href="/about-us">About-Us</Link>
```

- Link íƒœê·¸ë¥¼ ì´ìš©í•´ í˜ì´ì§€ ê°„ ë¼ìš°í„°ë¥¼ ë” ì‰½ê³  ê°„í¸í•˜ê²Œ ì“¸ ìˆ˜ ìˆë‹¤. í˜ì‹ 

## SSR ?

`Server Side Rendering` ì˜ ì•½ìì´ë©°, next.jsì˜ íŠ¹ì§• ì¤‘ í•˜ë‚˜ì´ë‹¤.
Reactê°€ ì‚¬ìš©í•˜ëŠ” CSR(Client Side Rendering)ê³¼ ë‹¤ë¥¸ ì ì„ ê°€ì§€ê³  ìˆë‹¤.

1. **ë¹ ë¥¸ ì´ˆê¸° ë Œë”ë§ ì†ë„**
   - CSRì„ ì‚¬ìš©í•˜ëŠ” Reactì˜ ê²½ìš° javascriptê°€ íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œí•˜ëŠ” ì‹œê°„ì´ ë Œë”ë§ ê³¼ì •ì— í¬í•¨ë˜ì–´ ì´ˆê¸° ë Œë”ë§ì´ ëŠë¦¬ë‹¤ëŠ” ì ì´ ìˆë‹¤. í•˜ì§€ë§Œ SSRì˜ ê²½ìš° ì„œë²„ ìª½ì—ì„œ ë Œë”ë§ì„ ì§„í–‰í•˜ê¸° ë•Œë¬¸ì—, ì´ˆê¸° ë Œë”ë§ì´ êµ‰ì¥íˆ ë¹ ë¥´ê²Œ ëœë‹¤.
   - ë˜í•œ ì‚¬ìš©ìê°€ í˜ì´ì§€ì— ì ‘ê·¼í•˜ë“  ì•ˆí•˜ë“  ì„œë²„ì—ì„œ ì½”ë“œë¥¼ ê°€ì ¸ê°€ ë¹„ë™ê¸°ì ì¸ HTMLë¡œ ë³€í™˜ ì‹œì¼œ ë†“ê¸° ë•Œë¬¸ì— ì‚¬ìš©ìëŠ” í˜ì´ì§€ì— ì ‘ì†í•˜ìë§ˆì UIë¥¼ ë³¼ ìˆ˜ ìˆë‹¤. ê·¸ í›„ JavaScriptë¥¼ ë‹¤ìš´ë¡œë“œ í•˜ì—¬ ë™ì ì´ê²Œ ë³€í•˜ê²Œ í•œë‹¤.
2. **SEO**
   - SEOëŠ” ê²€ìƒ‰ì—”ì§„ìµœì í™”ë¥¼ ëœ»í•œë‹¤. CSRì˜ ê²½ìš° ì´ˆê¸° javascriptê°€ ë‹¤ìš´ë¡œë“œ ë˜ê¸° ì „ê¹Œì§€ëŠ” root divì•ˆì— ì•„ë¬´ëŸ° ì½”ë“œê°€ ì—†ê¸° ë•Œë¬¸ì— êµ¬ê¸€ì—ì„œ í˜ì´ì§€ë¥¼ ìƒë‹¨ì— ë„ì›Œì£¼ì§€ ì•ŠëŠ”ë‹¤. í•˜ì§€ë§Œ SSRì˜ ê²½ìš° ì„œë²„ì—ì„œ ë Œë”ë§ í•˜ê¸° ë•Œë¬¸ì— (ì¦‰ javascriptë¥¼ ë¹„í™œì„±í•´ë„ í˜ì´ì§€ê°€ ë Œë”ë§ ë¨) root divì•ˆì— ì½”ë“œê°€ ì¡´ì¬í•˜ì—¬ SEOê°€ í¸ë¦¬í•˜ë‹¤ëŠ” ì ì´ ìˆë‹¤.

## Hydrate

SSRì˜ ì´ë¡  `'use client' ë¥¼ ì‘ì„±í•œ ì½”ë“œì—ì„œë§Œ ì‘ë™í•œë‹¤`

í˜ì´ì§€ê°€ ë¡œë“œë˜ë©´ ì„œë²„ì—ì„œ ë Œë”ë§ ëœ HTML ì½”ë“œë¥¼ ì‚¬ìš©ìê°€ ë°›ê²Œ ëœë‹¤. ê·¸ ì¦‰ì‹œ ë¸Œë¼ìš°ì €ì—ì„œ React ì™€ ê°™ì€ í”„ë ˆì„ì›Œí¬ê°€ initë˜ë©° í˜ì´ì§€ê°€ ë™ì ìœ¼ë¡œ ë³€í•œë‹¤.

`use client` ë¥¼ ì‘ì„±í•˜ì§€ ì•Šì€ íŒŒì¼ì—ì„œëŠ” hydrateê°€ ë˜ì§€ ì•Šì•„ ë™ì ìœ¼ë¡œ ë°”ë€Œì§€ ì•ŠëŠ”ë‹¤. ì´ëŠ” í•„ìš”í•œ ì½”ë“œë§Œ hydrateí•˜ê¸° ë•Œë¬¸ì— í˜ì´ì§€ì— ë¶€ë‹´ì´ ëœ ê°€ê²Œ í•œë‹¤.

## Client Component & Server Component

ì½”ë“œ ìƒë‹¨ì— `use client`ë¥¼ ì‘ì„±í•œ ì»´í¬ë„ŒíŠ¸ë¥¼ `Client Component`ë¼ê³  ì¹­í•œë‹¤.
~~ë‚˜ë¨¸ì§€ëŠ” `Server Client`ë¼ê³  í•¨~~

### **ì°¨ì´ì **

**Client Component**

- ì„œë²„ì—ì„œ ë Œë”ë§ ë˜ì–´ ì „ë‹¬ëœ HTML íŒŒì¼ì—ì„œ í”„ë ˆì„ì›Œí¬ë¥¼ ë™ì‘ ì‹œì¼œ ë™ì ì´ê²Œ ë§Œë“ ë‹¤.

**Server Component**

- í”„ë ˆì„ì›Œí¬ë¥¼ ë™ì‘ ì‹œí‚¤ì§€ ì•Šê¸° ë•Œë¬¸ì— ë¸Œë¼ìš°ì €ì—ì„œ javascriptë¥¼ ë‹¤ìš´ë¡œë“œ í•  í•„ìš”ì„±ì´ ì—†ê²Œ ëœë‹¤. ê·¸ë¡œ ì¸í•´ ë¶€í•˜ê°€ ì¤„ì–´ë“¤ê²Œ ëœë‹¤.

### ê³µí†µì 

- ë‘ Component ëª¨ë‘ `ì„œë²„ì—ì„œ ë Œë”ë§` ëœë‹¤ëŠ” ì ì´ ìˆë‹¤.

**ë‘ Component ëª¨ë‘ backendì—ì„œ SSRë¡œ ë Œë”ë§ ëœë‹¤ëŠ” ì ì„ ìŠì§€ ë§ì. (use clientëŠ” clientì—ì„œ ë Œë”ë§ ëœë‹¤ëŠ”ê²Œ ì•„ë‹Œ clientì—ì„œë„ ë Œë”ë§ ë  ìˆ˜ ìˆë‹¤ëŠ” ëœ»ì´ë‹¤.)**

## Layout !

- LayoutëŠ” ì»´í¬ë„ŒíŠ¸ë¥¼ `ì¤‘ë³µ ì‚¬ìš©í•˜ëŠ” ê²ƒ`ì„ ë§‰ì•„ì¤€ë‹¤.
  ```tsx
  import Navigation from "../components/navigation";

  export const metadata = {
    title: "Next.js",
    description: "Generated by Next.js",
  };

  export default function Layout({ children }: { children: React.ReactNode }) {
    return (
      <html lang="en">
        <body>
          <Navigation />
          {children} {// childrenì´ ì˜ë¯¸í•˜ëŠ” ê²ƒì€ ì ‘ê·¼í•œ í˜ì´ì§€ì˜ í•¨ìˆ˜ë¥¼ ì˜ë¯¸í•œë‹¤.}
        </body>
      </html>
    );
  }

  /* about-us í˜ì´ì§€ì— ì ‘ê·¼í•œ ì˜ˆì‹œ
  <Layout>
  	<AboutPage/>
  </Layout>
  */
  ```

### ì—¬ëŸ¬ê°œì˜ Layout

- `Layoutì€ ì—¬ëŸ¬ê°œ ë§Œë“¤ ìˆ˜ ìˆë‹¤.`
  ```bash

  íŒŒì¼ êµ¬ì¡°
  â”œâ”€â”€ app
  â”‚   â”œâ”€â”€ page.tsx
  â”‚   â”œâ”€â”€ layout.tsx
  â”‚   â””â”€â”€ about-us
  â”‚	      â”œâ”€â”€ layout.tsx
  â”‚		    â””â”€â”€ about-me
  â”‚		        â””â”€â”€ page.tsx
  â”‚
  â”‚
  ```
  ```tsx
  // app/about-us/about-me/page.tsxì— ì ‘ê·¼í•œ ì˜ˆì‹œ
  <Layout>
    <AboutUsLayout>
      <AboutMePage />
    </AboutUsLayout>
  </Layout>
  ```
  `app/page.tsx` ì—ëŠ” `app/layout.tsx` ë§Œ ë‚˜íƒ€ë‚˜ì§€ë§Œ, `app/about-us/about-me/page.tsx` ì—ëŠ” `app/layout.tsx` ì™€ `app/about-us/layout.tsx` ë‘˜ ë‹¤ ë‚˜íƒ€ë‚˜ê²Œ ëœë‹¤.

## Group Route ?

ë¼ìš°íŠ¸ë¥¼ ê·¸ë£¹ìœ¼ë¡œ ë¬¶ì„ ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì´ë‹¤. ì˜ˆë¥¼ ë“¤ë©´ ê¸°ì¡´ `app/page.tsx`ë¥¼ `app/(home)/page.tsx` ë¡œ í•˜ì—¬ pageê°€ homeì— ì†í•´ìˆëŠ” ë“¯í•œ ëŠë‚Œì„ ì£¼ëŠ” ê²ƒì„ ë§í•œë‹¤. ì—¬ê¸°ì„œ homeì„ ê´„í˜¸ë¡œ ë¬¶ì€ ì´ìœ ëŠ” nextëŠ” í´ë” ì´ë¦„ìœ¼ë¡œ urlì„ ìƒì„±í•˜ëŠ”ë° í´ë”ëª…ì´ ê´„í˜¸ë¡œ ë¬¶ì—¬ ìˆë‹¤ë©´ urlì„ ìƒì„±í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì´ë‹¤.

## Metadata ?

í”„ë¡ íŠ¸ì—”ë“œë¥¼ ê³µë¶€í–ˆë‹¤ë©´ metadataê°€ ë¬´ì—‡ì¸ì§€ëŠ” ì•Œê³  ìˆì„ ê²ƒì´ë‹¤. nextì˜ metadataëŠ” ê¸°ì¡´ì— ì‚¬ìš©í•˜ë˜ metadataì™€ ì¡°ê¸ˆ ë‹¤ë¥´ê²Œ ì‚¬ìš© í•  ìˆ˜ ìˆë‹¤.

`metadataëŠ” Server Componentì—ì„œë§Œ ë‚´ë³´ë‚¼ ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ ëª…ì‹œí•˜ì`

1. **`ë¨¼ì € ê° layoutì—ì„œ metadataë¥¼ ì„¤ì • í•  ìˆ˜ ìˆë‹¤.` ê¸°ì¡´ì˜ reactì—ì„œëŠ” index.html íŒŒì¼ì— ìˆë˜ metadataë¥¼ í˜ì´ì§€ ë§ˆë‹¤ ë‹¤ë¥´ê²Œ ì„¤ì • í•  ìˆ˜ ìˆë‹¤.**

   ```tsx
   // app/layout ì˜ metadata
   import { Metadata } from "next";

   export const metadata: Metadata = {
     title: {
       template: "%s | Next Movies",
       default: "Next Movies", // defaultëŠ” metadataê°€ ì„¤ì • ë˜ì–´ìˆì§€ ì•Šì€ í˜ì´ì§€ì˜ titleì„ ì˜ë¯¸í•œë‹¤
       },
     description: "The best Movies on the best framework",
   };

   // app/about-us/layout ì˜ metadata
   import { Metadata } from "next";

   export const metadata: Metadata = {
     title: "About-us ",
   };

   // app/(home) ì˜ metadata
   export const metadata = {
     title: "Home ",
     description: "The best Movies on the best framework",
   };

   home í˜ì´ì§€ì—ì„œì˜ titleì€ "Home | Next Movies" ì´ë©°, about-us í˜ì´ì§€ì—ì„œì˜ titleì€
   "About-us | Next Movies" ì´ë‹¤.
   ```

## Dynamic Routing

`ë™ì  ë¼ìš°íŒ…`ì´ë¼ê³ ë„ ë¶ˆë¦°ë‹¤.

### ë™ì  ë¼ìš°íŒ… vs ì •ì  ë¼ìš°íŒ…

- ë™ì  ë¼ìš°íŒ…ì€ `movies/12` , `movies/12131` ì™€ ê°™ì´ urlì— ë³€ê²½í•  ìˆ˜ ìˆëŠ” ê°’ì´ ë“¤ì–´ê°€ëŠ” ë¼ìš°íŒ… ë°©ì‹ì´ë‹¤
- ì •ì  ë¼ìš°íŒ…ì€ [localhost:3000/app](http://localhost:3000/app) , [localhost:3000/about-us](http://localhost:3000/about-us) ì™€ ê°™ì´ ë³€í•˜ì§€ ì•ŠëŠ” url ì„ ë§í•œë‹¤.

### Nextì˜ ë™ì  ë¼ìš°íŒ…

ë³€í•˜ê²Œ í•  ê°’ì„ `ëŒ€ê´„í˜¸`ë¡œ ë¬¶ìœ¼ë©´ ë™ì  ë¼ìš°íŒ…ì„ í‘œí˜„í•  ìˆ˜ ìˆë‹¤.

```bash
â”œâ”€â”€ app
â”‚   â””â”€â”€ movies
â”‚	      â””â”€â”€ [id]
â”‚		        â””â”€â”€ page.tsx
â”‚
â”‚
â”‚
```

```tsx
// app/movies/[id]/page.tsx

export default function MovieDetails({
  params: { id }, // êµ¬ì¡°ë¶„í•´í• ë‹¹
}: {
  params: { id: string }; // íƒ€ì… ì„¤ì •
}) {
  return <h1>Movie {id}!</h1>;
}

// movies/11 ì´ urlì´ë¼ë©´ id ê°’ì€ 11ì´ ëœë‹¤.
```

# DATA FETCHING

## ê¸°ì¡´ì˜ ì—°ë™ ë°©ì‹

ê¸°ì¡´ì˜ ì—°ë™ ë°©ì‹ì€ ì§ì ‘ `ë¡œë”©` ìƒíƒœë¥¼ í‘œí˜„í•´ì•¼ í–ˆìœ¼ë©°, `useState`, `useEffect` ë¥¼ ì‚¬ìš©í•´ì•¼ í–ˆê¸° ë•Œë¬¸ì—, `"use client"` ë¥¼ ì‘ì„±í–ˆì–´ì•¼ í–ˆë‹¤. í•˜ì§€ë§Œ `"use client"` ë¥¼ ì‚¬ìš©í•˜ë©´ `metadata`ë¥¼ ì‚¬ìš© í•  ìˆ˜ ì—†ë‹¤ëŠ” ë¬¸ì œì ì´ ì¡´ì¬í•œë‹¤.

```tsx
"use client";

import { useEffect, useState } from "react";

export default function FirstPage() {
  const [isLoading, setIsLoading] = useState(true);
  const [movies, setMovies] = useState([]);
  const getMovies = async () => {
    const response = await fetch(
      "https://nomad-movies.nomadcoders.workers.dev/movies"
    );
    const json = await response.json();
    setMovies(json);
    setIsLoading(false);
  };
  useEffect(() => {
    getMovies();
  }, []);
  return <div>{isLoading ? "loading..." : JSON.stringify(movies)}</div>;
}
```

## ì„œë²„ í´ë¼ì´ì–¸íŠ¸ ì—°ë™ ë°©ì‹

ì´ ì—°ë™ ë°©ì‹ì€ `useState` ì™€ `useEffect` ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³  ì—°ë™ì„ í•  ìˆ˜ ìˆë‹¤. ë°±ì—”ë“œì—ì„œ ì‹¤í–‰í•˜ê¸° ë•Œë¬¸ì—, `metadata` ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìœ¼ë©°, ì½”ë“œë„ ê°„ë‹¨í•˜ë‹¤. ì´ ì—°ë™ ë°©ì‹ì„ ì‚¬ìš©í•œë‹¤ë©´ `loading` ìƒíƒœëŠ” UIë¡œ ë‚˜íƒ€ë‚˜ì§€ ì•ŠëŠ”ë‹¤. ë°±ì—”ë“œ ì„œë²„ì—ì„œ ì—°ë™ì´ ë˜ê¸° ë•Œë¬¸ì´ë‹¤.

ì´ ì—°ë™ ë°©ì‹ì˜ ë‹¨ì ìœ¼ë¡œëŠ” ì—°ë™ì´ ë‹¤ ë˜ê¸° ì „ê¹Œì§€ ì‚¬ìš©ìëŠ” ì•„ë¬´ê²ƒë„ ë³¼ ìˆ˜ ì—†ë‹¤ëŠ” ì ì´ ìˆë‹¤. nextëŠ” `SSR` ë°©ì‹ì´ê¸° ë•Œë¬¸ì—, ì„œë²„ì—ì„œ ë Œë”ë§ ëœ htmlì„ ì‚¬ìš©ìì—ê²Œ ì „ë‹¬í•˜ëŠ”ë°, ì—°ë™ì´ ë‹¤ ë˜ê¸° ì „ê¹Œì§€ëŠ” ì„œë²„ì—ì„œ ì´ ì‘ì—…ì„ í•˜ì§€ ì•ŠëŠ”ë‹¤.

```tsx
export const metadata = {
  title: "Home",
};

const URL = "https://nomad-movies.nomadcoders.workers.dev/movies";

async function getMovies() {
  return fetch(URL).then(response => response.json());
}

export default async function HomePage() {
  const movies = await getMovies();
  return <div>{JSON.stringify(movies)}</div>;
}
```

### ë¬¸ì œ í•´ê²°?

```tsx
//(home)/loading.tsx

export default function Loading() {
  return <h2>Loading...</h2>;
}
```

ì´ëŸ¬í•œ ë‹¨ì ì„ í•´ê²°í•˜ê¸° ìœ„í•´ì„œ, ì—°ë™ì„ í•˜ëŠ” íŒŒì¼ì´ ìˆëŠ” í´ë”ì— `loading.tsx` ë¥¼ ìƒì„±í•˜ì—¬ ì‚¬ìš©ìì—ê²Œ loading ì´ë¼ëŠ” UIë¥¼ ë³´ì—¬ì¤„ ìˆ˜ ìˆë‹¤. ê·¸ì € íŒŒì¼ì„ ì¶”ê°€í•˜ëŠ” ê²ƒìœ¼ë¡œì¨ loading ì„ ë³´ì—¬ì£¼ëŠ”ê±¸ êµ¬í˜„í•˜ëŠ” ê²ƒì´ë‹¤. nextë¥¼ ì²˜ìŒ í•˜ëŠ” ë‚´ ì…ì¥ìœ¼ë¡œì¨ëŠ” êµ‰ì¥íˆ ë†€ë¼ìš´ ì ì´ë‹¤.

ì´ë¥¼ í†µí•´ nextëŠ” `í˜ì´ì§€ë¥¼ ì‘ì€ htmlì„ ë‚˜ëˆ„ì–´ì„œ` ì‚¬ìš©ìì—ê²Œ ë³´ì—¬ì¤€ë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. navigation ì»´í¬ë„ŒíŠ¸ë‚˜ layout ê°™ì€ ê²ƒì„ ë³´ì—¬ì£¼ê³  loadingì„ ë³´ì—¬ì¤€ë‹¤. ê·¸ ë’¤ ì—°ë™ì´ ë‹¤ ë˜ì—ˆë‹¤ë©´ ì—°ë™ì˜ ê²°ê³¼ë¥¼ ë³´ì—¬ì¤€ë‹¤.

### ë‘ê°œì˜ fetch()

```tsx
import { API_URL } from "../../../(home)/page";

async function getMovie(id: string) {
  console.log(`Fetching movies: ${Date.now()}`);
  await new Promise(resolve => setTimeout(resolve, 5000));
  const response = await fetch(`${API_URL}/${id}`);
  return response.json();
}

async function getVideos(id: string) {
  console.log(`Fetching videos: ${Date.now()}`);
  await new Promise(resolve => setTimeout(resolve, 5000));
  const response = await fetch(`${API_URL}/${id}/videos`);
  return response.json();
}

export default async function MoviesDetail({
  params: { id },
}: {
  params: { id: string };
}) {
  console.log("=================");
  console.log("start fetching");
  const [movie, videos] = await Promise.all([getMovie(id), getVideos(id)]);
  console.log("end fetching");
  return <h1>{movie.title}</h1>;
}
```

getMovieì™€ getVideosëŠ” ì—°ë™ í•˜ëŠ”ë° 5ì´ˆì˜ ì‹œê°„ì´ ê±¸ë¦°ë‹¤. ê·¸ë ‡ê¸° ë•Œë¬¸ì— ìµœì†Œ 10ì´ˆì˜ ì—°ë™ ì‹œê°„ì´ ê±¸ë¦¬ëŠ”ë° ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ì„œ `Promise.all`ì„ ì‚¬ìš©í•œë‹¤. `Promise.all`ì€ `fetch`ë¥¼ ë™ì‹œì— ì§„í–‰í•˜ê¸° ë•Œë¬¸ì— ì—°ë™ì„ ìµœì í™” í•  ìˆ˜ ìˆë‹¤.

### ë¶„í• í•´ì„œ ì—°ë™í•˜ê¸°

```tsx
import { Suspense } from "react";
import MovieInfo from "../../../../components/movie-info";
import MovieVideos from "../../../../components/movie-videos";

export default async function MoviesDetail({
  params: { id },
}: {
  params: { id: string };
}) {
  return (
    <div>
      <Suspense fallback={<h1>Loading movie info</h1>}>
        <MovieInfo id={id} />
      </Suspense>
      <Suspense fallback={<h1>Loading movie videos</h1>}>
        <MovieVideos id={id} />
      </Suspense>
    </div>
  );
}
```

`Promise.all`ì„ ì‚¬ìš©í•˜ì—¬ ì—°ë™ì„ í•  ê²½ìš°ì—ëŠ” ëª¨ë“  ì—°ë™ì´ ì™„ë£Œë˜ì–´ì•¼ ê²°ê³¼ë¥¼ ë°›ì„ ìˆ˜ ìˆë‹¤. ê·¸ë¡œ ì¸í•´ í•œê°€ì§€ ì—°ë™ì´ ë¹¨ë¦¬ ë˜ì–´ë„ ë‚˜ë¨¸ì§€ ì—°ë™ì´ ì™„ë£Œë˜ì§€ ì•Šì•˜ë‹¤ë©´, ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ì—†ëŠ” ê²ƒì´ë‹¤. ê·¸ë ‡ê¸° ë•Œë¬¸ì— `Suspense`ë¥¼ ì‚¬ìš©í•œë‹¤. Suspenseì˜ `fallback props`ëŠ” í•´ë‹¹ Suspenseì•ˆì˜ ì—°ë™ì´ ëë‚˜ê¸° ì „ê¹Œì§€ ë³´ì—¬ì£¼ëŠ” UIë¥¼ ì„¤ì • í•  ìˆ˜ ìˆë‹¤. ë˜í•œ ì—°ë™ì„ ë¶„í•  í–ˆê¸° ë•Œë¬¸ì—, í•˜ë‚˜ê°€ ëë‚ ë•Œë§ˆë‹¤ ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤. `Suspense`ëŠ” `next`ê°€ ì•„ë‹Œ `react`ì— ìˆìŒì„ ê¸°ì–µí•˜ì

### error ì²˜ë¦¬

![image.png](attachment:113a24a1-b5de-4b98-84c1-2652fd707e53:image.png)

```tsx
"use client"; // error.tsx ì—ëŠ” ë°˜ë“œì‹œ 'use client' ë¥¼ ì¶”ê°€í•˜ì

export default function Error() {
  return <h1>lol error</h1>;
}
```

`error.tsx`ë¥¼ ìƒì„±í•´ì£¼ë©´, movies/id ì—ì„œì˜ ì—ëŸ¬ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤.

# **Deployment**

## **CSS Modules**

Nextì—ì„œì˜ css ì ìš© ë°©ë²•ì´ë‹¤(.css íŒŒì¼ì„ ì´ìš©í•´ì„œ)

```tsx
// app/layout.tsx
import "../styles/global.css";
import { Metadata } from "next";
import Navigation from "../components/navigation";

export const metadata: Metadata = {
  title: {
    template: "%s | Next Movies",
    default: "Next Movies",
  },
  description: "The best Movies on the best framework",
};

export default function Layout({ children }: { children: React.ReactNode }) {
  return (
    <html lang="en">
      <body>
        <Navigation />
        {children}
      </body>
    </html>
  );
}
```

`import "../styles/global.css";` ì´ëŸ¬í•œ ë°©ì‹ìœ¼ë¡œ global.cssë¥¼ í˜ì´ì§€ ì „ì²´ì— ì ìš©í•  ìˆ˜ ìˆë‹¤. app/layout.tsxì— ì‘ì„±í•´ì•¼ í˜ì´ì§€ ì „ì²´ì— ì ìš©í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ ëª…ì‹¬í•˜ì.

### í˜ì´ì§€ ì „ì²´ê°€ ì•„ë‹Œ íŠ¹ì • í˜ì´ì§€(ì»´í¬ë„ŒíŠ¸)ì—ì„œì˜ css ì ìš©?

globalì´ ì•„ë‹Œ íŠ¹ì • ìš”ì†Œì˜ cssë¥¼ ì •ì˜í•˜ê¸° ìœ„í•´ì„œëŠ” `module.css` ë¥¼ ì´ìš©í•´ì•¼ í•œë‹¤.

```tsx
// components/navigation.tsx
"use client";

import Link from "next/link";
import { usePathname } from "next/navigation";
import styles from "../styles/navigation.module.css";

export default function Navigation() {
  const path = usePathname();

  return (
    <nav className={styles.nav}>
      <ul className={styles.list}>
        <li>
          <Link href="/">Home</Link>
          {path === "/" ? "ğŸ”¥" : ""}
        </li>
        <li>
          <Link href="/about-us">About-Us</Link>
          {path === "/about-us" ? "ğŸ”¥" : ""}
        </li>
      </ul>
    </nav>
  );
}
```

`import styles from "../styles/navigation.module.css";` ë¥¼ ì´ìš©í•´ì„œ `module.css` ë¥¼ import í•´ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ì‚¬ìš© ë°©ë²•ì€ `module.css` ì—ì„œ ì„ ì–¸í•œ í´ë˜ìŠ¤ ì´ë¦„ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

## **Dynamic Metadata**

```tsx
// (home)/page.tsx
export const metadata: Metadata = {
  title: "Home",
};

// movies/[id]/page.tsx
export const generateMetadata = async ({
  params,
}: IParams): Promise<Metadata> => {
  const movie = await getMovie(params.id);
  // getMovieë¥¼ í˜¸ì¶œ í•˜ê¸° ë–„ë¬¸ì— ìºì‹± ë˜ì–´ ë‹¤ìŒ ìš”ì²­ì„ ìºì‹±ëœ ë°ì´í„°ë¥¼ ì‚¬ìš©í•œë‹¤
  return {
    title: movie.title,
  };
};
```

`generateMetadata` ë¥¼ ì´ìš©í•˜ì—¬ [id]ì™€ ê°™ì´ ë™ì ì¸ ê²½ë¡œë¥¼ ê°€ì§„ í˜ì´ì§€ì—ì„œ, í˜ì´ì§€ì˜ ë‚´ìš©(ì˜ˆ: íŠ¹ì • ì˜í™” ì œëª©)ì— ë”°ë¼ <title> íƒœê·¸ë‚˜ <meta> íƒœê·¸ì˜ ë‚´ìš©ì„ ë‹¤ë¥´ê²Œ ì„¤ì •í•  ìˆ˜ ìˆë‹¤

## Prefetch

`Link` íƒœê·¸ì— `prefetch`ë¥¼ ì„¤ì •í•˜ë©´ nextJsëŠ” ìœ ì €ê°€ `Link`ë¥¼ í´ë¦­í•˜ê¸° ì „ì— ë¯¸ë¦¬ `fetch` í•´ë‘”ë‹¤

```tsx
const Movie = ({ title, id, poster_path }: IMovieProps) => {
  const router = useRouter();
  const onClick = () => {
    router.push(`/movies/${id}`);
  };
  return (
    <div className={styles.movie}>
      <img src={poster_path} alt={title} onClick={onClick} />
      <Link prefetch href={`/movies/${id}`}>
        {title}
      </Link>
    </div>
  );
};
```
